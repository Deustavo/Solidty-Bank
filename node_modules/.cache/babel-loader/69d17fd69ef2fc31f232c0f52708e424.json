{"ast":null,"code":"var _jsxFileName = \"/Users/douglasmorais/Documents/GitHub/desafio-accenture-react/src/Pages/Landing/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useCallback, useEffect, useRef } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { FaArrowRight } from 'react-icons/fa';\nimport { Form } from '@unform/web';\nimport * as yup from 'yup';\nimport api from '../../services/api';\nimport getIsAuth from '../../services/getIsAuth';\nimport getValidationErrors from '../../utils/getValidationErrors';\nimport { maskCPF, removeMaskCPF } from '../../utils/mask';\nimport Header from '../../components/Header';\nimport Input from '../../components/Input';\nimport Loader from '../../components/Loader';\nimport ImgCellPhone from '../../assets/landing-3.png';\nimport { toast } from 'react-toastify';\nimport updateReduxState from '../../services/updateReduxState';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Landing = () => {\n  _s();\n\n  const [username, setUsername] = useState('');\n  const [name, setName] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [cpf, setCpf] = useState('');\n  const [cpfMask, setCpfMask] = useState('');\n  const [loading, setLoading] = useState(false);\n  const history = useHistory();\n  const formRef = useRef(null);\n  const [isFilled, setIsFilled] = useState(false); // Atualiza a mascara do CPF\n\n  useEffect(() => {\n    setCpf(removeMaskCPF(cpfMask));\n  }, [cpfMask]); // Atualiza se todos os campos estão preenchidos para deixar o botão de confirmar verde\n\n  useEffect(() => {\n    if (name.length > 3 && password && confirmPassword && cpf.length === 11 && username) setIsFilled(true);else setIsFilled(false);\n  }, [name, password, confirmPassword, cpf, username]); // Lidar com o registro\n\n  const handleSubmit = useCallback(async data => {\n    const filteredData = {};\n    Object.keys(data).forEach(key => {\n      filteredData[key] = data[key].trim();\n    });\n    setLoading(true);\n\n    try {\n      var _formRef$current;\n\n      (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setErrors({});\n      const schema = yup.object().shape({\n        cpf: yup.string().min(14, 'Obrigatório ter 11 digitos'),\n        username: yup.string().required('Nome de usuário obrigatório '),\n        name: yup.string().required('Nome completo obrigatório'),\n        password: yup.string().min(6, 'No mínimo 6 digitos'),\n        confirmPassword: yup.string().min(6, 'No mínimo 6 digitos')\n      });\n      await schema.validate(filteredData, {\n        abortEarly: false\n      });\n\n      if (password !== confirmPassword) {\n        return;\n      }\n\n      const {\n        status\n      } = await api.post('/usuarios', {\n        \"cpf\": cpf,\n        \"login\": username,\n        \"nome\": name,\n        \"senha\": password\n      });\n\n      if (status === 200 || status === 201) {\n        const {\n          data\n        } = await api.post('/login', {\n          usuario: username,\n          senha: password\n        });\n        localStorage.setItem('@token_user', data.token);\n        localStorage.setItem('@user_name', data.usuario.nome);\n        updateReduxState();\n        toast.success('Usuário registrado!');\n        history.push('/dashboard');\n      } else {\n        toast.error('Ocorreu algum erro!');\n        history.push('/error');\n      }\n    } catch (err) {\n      var _formRef$current2;\n\n      const errors = getValidationErrors(err);\n      (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.setErrors(errors);\n      toast.error('O formulário está incorreto!');\n    } finally {\n      setLoading(false);\n    }\n  }, [cpf, username, name, password, confirmPassword, history]); // Check if user is authenticated\n\n  const handleRedirectToLogin = useCallback(() => {\n    const isAuth = getIsAuth();\n    if (isAuth) history.push('/dashboard');else history.push('/login');\n  }, [history]);\n  const handleSetCpfMask = useCallback(e => {\n    setCpfMask(maskCPF(removeMaskCPF(e.target.value)));\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"Gama Bank \\xE9 um projeto de nossos alunos.\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \" J\\xE1 tem conta?\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 139,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: handleRedirectToLogin,\n              children: [\"Acessar \", /*#__PURE__*/_jsxDEV(FaArrowRight, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 141,\n                columnNumber: 63\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              ref: formRef,\n              onSubmit: handleSubmit,\n              children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \" Pe\\xE7a sua conta e cart\\xE3o de cr\\xE9dito do Gama Bank\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                name: \"cpf\",\n                maxLength: 14,\n                value: cpfMask,\n                onChange: handleSetCpfMask,\n                placeholder: \"Digite seu CPF\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                name: \"username\",\n                value: username,\n                onChange: e => setUsername(e.target.value),\n                placeholder: \"Escolha um nome de usu\\xE1rio\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                name: \"name\",\n                value: name,\n                onChange: e => setName(e.target.value),\n                placeholder: \"Nome completo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                name: \"password\",\n                value: password,\n                type: \"password\",\n                onChange: e => setPassword(e.target.value),\n                placeholder: \"Digite sua senha\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Input, {\n                name: \"confirmPassword\",\n                value: confirmPassword,\n                type: \"password\",\n                onChange: e => setConfirmPassword(e.target.value),\n                placeholder: \"Confirme sua senha\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 17\n              }, this), loading ? /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 28\n              }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                children: [\"Continuar\", /*#__PURE__*/_jsxDEV(FaArrowRight, {\n                  className: \"ArrowRight\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 72\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Conta digital do Gama Academy\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 163,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Rende mais que a poupan\\xE7a, sem taxa de manuten\\xE7\\xE3o nem tarifas escondidas.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Cart\\xE3o de Cr\\xE9dito\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Rende mais que a poupan\\xE7a, sem taxa de manuten\\xE7\\xE3o nem tarifas escondidas.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Zero anuidade\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Burocracia custa caro. Somos eficientes para voc\\xEA n\\xE3o ter que pagar tarifas.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"0,00\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"O fim da complexibilidade\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Para quem sabe que tecnologia e design s\\xE3o melhores do que ag\\xEAncias e papelada.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Simplifique a sua vida. Pe\\xE7a seu convite.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"GamaAcademy Bank Line S.A. - CNPJ 00.000.000/0000-00\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Rua Fict\\xEDcia, 999 - 00000-000 - S\\xE3o Paulo, SP\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Este \\xE9 um projeto de avalia\\xE7\\xE3o | GamaAcademy | Accenture | 2021\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: ImgCellPhone,\n              alt: \"Imagem de um celular\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Landing, \"wtsYtvvAuPxEaKBbxmE7+2WEUDo=\", false, function () {\n  return [useHistory];\n});\n\n_c = Landing;\nexport default Landing;\n\nvar _c;\n\n$RefreshReg$(_c, \"Landing\");","map":{"version":3,"sources":["/Users/douglasmorais/Documents/GitHub/desafio-accenture-react/src/Pages/Landing/index.tsx"],"names":["React","useState","useCallback","useEffect","useRef","useHistory","FaArrowRight","Form","yup","api","getIsAuth","getValidationErrors","maskCPF","removeMaskCPF","Header","Input","Loader","ImgCellPhone","toast","updateReduxState","Landing","username","setUsername","name","setName","password","setPassword","confirmPassword","setConfirmPassword","cpf","setCpf","cpfMask","setCpfMask","loading","setLoading","history","formRef","isFilled","setIsFilled","length","handleSubmit","data","filteredData","Object","keys","forEach","key","trim","current","setErrors","schema","object","shape","string","min","required","validate","abortEarly","status","post","usuario","senha","localStorage","setItem","token","nome","success","push","error","err","errors","handleRedirectToLogin","isAuth","handleSetCpfMask","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect, ChangeEvent, useRef } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { FaArrowRight } from 'react-icons/fa';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport * as yup from 'yup';\nimport api from '../../services/api';\nimport getIsAuth from '../../services/getIsAuth';\nimport getValidationErrors from '../../utils/getValidationErrors';\nimport { maskCPF, removeMaskCPF } from '../../utils/mask';\n\n\n\nimport Header from '../../components/Header';\nimport Input from '../../components/Input';\nimport Loader from '../../components/Loader';\n\nimport ImgCellPhone from '../../assets/landing-3.png';\nimport { toast } from 'react-toastify';\nimport { AnyObject } from '../../types/utils';\nimport { UserResponse } from '../../types/user';\nimport updateReduxState from '../../services/updateReduxState';\n\nconst Landing: React.FC = () => {\n  const [username, setUsername] = useState('');\n  const [name, setName] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [cpf, setCpf] = useState('');\n  const [cpfMask, setCpfMask] = useState('');\n  const [loading, setLoading] = useState(false);\n  const history = useHistory();\n  const formRef = useRef<FormHandles>(null);\n\n  const [ isFilled, setIsFilled ] = useState(false);\n\n  // Atualiza a mascara do CPF\n  useEffect(() => {\n    setCpf(removeMaskCPF(cpfMask));\n  }, [cpfMask]);\n\n  // Atualiza se todos os campos estão preenchidos para deixar o botão de confirmar verde\n  useEffect(() => {\n    if ( name.length > 3 && \n      password && \n      confirmPassword && \n      cpf.length === 11 && \n      username ) setIsFilled(true);\n    else setIsFilled(false);\n  }, [name, password, confirmPassword, cpf, username]);\n\n  // Lidar com o registro\n  const handleSubmit = useCallback(async (data: AnyObject) => {\n    const filteredData: AnyObject = {}\n\n    Object.keys(data).forEach( key => {\n      filteredData[key] = data[key].trim();\n    });\n\n    setLoading(true);\n\n    try {\n      formRef.current?.setErrors({});\n\n      const schema = yup.object().shape({\n        cpf: yup.string().min(14, 'Obrigatório ter 11 digitos'),\n        username: yup.string().required('Nome de usuário obrigatório '),\n        name: yup.string().required('Nome completo obrigatório'),\n        password: yup.string().min(6, 'No mínimo 6 digitos'),\n        confirmPassword: yup.string().min(6, 'No mínimo 6 digitos')\n      });\n\n      await schema.validate(filteredData, {\n        abortEarly: false\n      });\n\n      if (password !== confirmPassword) {\n        return;\n      }\n\n      const { status } = await api.post('/usuarios', {\n        \"cpf\": cpf,\n        \"login\": username,\n        \"nome\": name,\n        \"senha\": password,\n      });\n\n      if (status === 200 || status === 201) {\n        const { data } = await api.post<UserResponse>('/login', {\n          usuario: username,\n          senha: password\n        });\n\n        localStorage.setItem('@token_user', data.token);\n        localStorage.setItem('@user_name', data.usuario.nome);\n        updateReduxState();\n\n        toast.success('Usuário registrado!');\n        history.push('/dashboard');\n      } else {\n        toast.error('Ocorreu algum erro!');\n        history.push('/error');\n      }\n    } catch (err) {\n      const errors = getValidationErrors(err);\n      formRef.current?.setErrors(errors);\n      toast.error('O formulário está incorreto!');\n    } finally {\n      setLoading(false);\n    }\n  }, [cpf, username, name, password, confirmPassword, history]);\n\n  // Check if user is authenticated\n  const handleRedirectToLogin = useCallback(() => {\n    const isAuth = getIsAuth();\n\n    if (isAuth) history.push('/dashboard');\n    else history.push('/login');\n  }, [history]);\n\n  const handleSetCpfMask = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    setCpfMask(\n      maskCPF(\n        removeMaskCPF(e.target.value)\n      )\n    );\n  }, []);\n\n  return (\n    <>\n      <Header />\n\n      <div>\n        <div>\n          <div>\n            <div>\n              <div>\n                <p>Gama Bank é um projeto de nossos alunos.\n                <span> Já tem conta?</span></p>\n              </div>\n              <button onClick={handleRedirectToLogin}>Acessar <FaArrowRight /></button>\n            </div>\n\n            <div>\n              <Form ref={formRef} onSubmit={handleSubmit}>\n                <h1> Peça sua conta e cartão de crédito do Gama Bank</h1>\n                <Input name=\"cpf\" maxLength={14} value={cpfMask} onChange={handleSetCpfMask} placeholder=\"Digite seu CPF\" />\n                <Input name=\"username\" value={username} onChange={e => setUsername(e.target.value)} placeholder=\"Escolha um nome de usuário\" />\n                <Input name=\"name\" value={name} onChange={e => setName(e.target.value)} placeholder=\"Nome completo\" />\n                <Input name=\"password\" value={password} type=\"password\" onChange={e => setPassword(e.target.value)} placeholder=\"Digite sua senha\" />\n                <Input name=\"confirmPassword\" value={confirmPassword} type=\"password\" onChange={e => setConfirmPassword(e.target.value)} placeholder=\"Confirme sua senha\" />\n                {loading ? <Loader /> : <button type=\"submit\">Continuar<FaArrowRight className=\"ArrowRight\" /></button>}\n              </Form>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <section>\n        <div>\n          <div>\n            <div>\n              <span>Conta digital do Gama Academy</span>\n              <p>Rende mais que a poupança, sem taxa de manutenção nem tarifas escondidas.</p>\n            </div>\n            <div>\n              <span>Cartão de Crédito</span>\n              <p>Rende mais que a poupança, sem taxa de manutenção nem tarifas escondidas.</p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <section>\n        <div>\n          <div>\n            <div>\n              <span>Zero anuidade</span>\n              <p>Burocracia custa caro. Somos eficientes para você não ter que pagar tarifas.</p>\n            </div>\n            <div>\n              <span>0,00</span>\n            </div>\n          </div>\n        </div>\n      </section>\n\n\n      <section>\n        <div>\n          <div>\n            <div>\n              <span>O fim da complexibilidade</span>\n              <p>Para quem sabe que tecnologia e design são melhores do que agências e papelada.</p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <div>\n        <div>\n          <div>\n            <div>\n              <span>Simplifique a sua vida. Peça seu convite.</span>\n              <p>GamaAcademy Bank Line S.A. - CNPJ 00.000.000/0000-00</p>\n\n              <p>Rua Fictícia, 999 - 00000-000 - São Paulo, SP</p>\n              <p>Este é um projeto de avaliação | GamaAcademy | Accenture | 2021</p>\n            </div>\n            <div>\n              <img src={ImgCellPhone} alt=\"Imagem de um celular\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default Landing;"]},"metadata":{},"sourceType":"module"}