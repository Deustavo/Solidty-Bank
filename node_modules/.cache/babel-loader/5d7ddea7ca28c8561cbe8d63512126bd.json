{"ast":null,"code":"import jwt from 'jsonwebtoken';\n// Estratégia para ver se o token ainda é valido\nexport const checkIsAuth = () => {\n  const localToken = localStorage.getItem('@token_user');\n  if (!localToken) return false;\n  const onlyToken = localToken.split(' ')[1];\n  const tokenPayload = jwt.decode(onlyToken);\n  const expSeconds = tokenPayload.exp;\n  const nowSeconds = Date.now() / 1000;\n\n  if (expSeconds < nowSeconds) {\n    localStorage.removeItem('@token_user');\n    localStorage.removeItem('@user_name');\n    window.location.reload();\n    return false;\n  }\n\n  return true;\n}; // Verificação\n\nconst getIsAuth = () => {\n  const localToken = localStorage.getItem('@token_user');\n  if (localToken && checkIsAuth()) return true;\n  return false;\n};\n\nexport default getIsAuth;","map":{"version":3,"sources":["/Users/douglasmorais/Documents/GitHub/desafio-accenture-react/src/services/getIsAuth.ts"],"names":["jwt","checkIsAuth","localToken","localStorage","getItem","onlyToken","split","tokenPayload","decode","expSeconds","exp","nowSeconds","Date","now","removeItem","window","location","reload","getIsAuth"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;AAGA;AACA,OAAO,MAAMC,WAAW,GAAG,MAAM;AAC7B,QAAMC,UAAU,GAAGC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAnB;AACA,MAAK,CAACF,UAAN,EAAmB,OAAO,KAAP;AAEnB,QAAMG,SAAS,GAAGH,UAAU,CAACI,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAlB;AACA,QAAMC,YAAY,GAAGP,GAAG,CAACQ,MAAJ,CAAYH,SAAZ,CAArB;AAEA,QAAMI,UAAU,GAAGF,YAAY,CAACG,GAAhC;AACA,QAAMC,UAAU,GAAGC,IAAI,CAACC,GAAL,KAAa,IAAhC;;AAEA,MAAKJ,UAAU,GAAGE,UAAlB,EAA+B;AAC3BR,IAAAA,YAAY,CAACW,UAAb,CAAwB,aAAxB;AACAX,IAAAA,YAAY,CAACW,UAAb,CAAwB,YAAxB;AAEAC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AAEA,WAAO,KAAP;AACH;;AAED,SAAO,IAAP;AACH,CApBM,C,CAuBP;;AACA,MAAMC,SAAS,GAAG,MAAM;AACpB,QAAMhB,UAAU,GAAGC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAnB;AAEA,MAAKF,UAAU,IAAID,WAAW,EAA9B,EAAmC,OAAO,IAAP;AAEnC,SAAO,KAAP;AACH,CAND;;AAQA,eAAeiB,SAAf","sourcesContent":["import jwt from 'jsonwebtoken';\n\nimport { TokenPayload } from '../types/user';\n// Estratégia para ver se o token ainda é valido\nexport const checkIsAuth = () => {\n    const localToken = localStorage.getItem('@token_user');\n    if ( !localToken ) return false;\n\n    const onlyToken = localToken.split(' ')[1];\n    const tokenPayload = jwt.decode( onlyToken ) as TokenPayload;\n    \n    const expSeconds = tokenPayload.exp;\n    const nowSeconds = Date.now() / 1000;\n\n    if ( expSeconds < nowSeconds ) {\n        localStorage.removeItem('@token_user');\n        localStorage.removeItem('@user_name');\n        \n        window.location.reload();\n\n        return false;\n    }\n\n    return true;\n}\n\n\n// Verificação\nconst getIsAuth = () => {\n    const localToken = localStorage.getItem('@token_user');\n    \n    if ( localToken && checkIsAuth() ) return true;\n    \n    return false;\n}\n\nexport default getIsAuth;"]},"metadata":{},"sourceType":"module"}